/*******************************************************************************
*   Vite Wallet for Ledger Nano S
*   (c) 2020 Vite Labs
*   (c) 2016 Ledger
*
*  Licensed under the Apache License, Version 2.0 (the "License");
*  you may not use this file except in compliance with the License.
*  You may obtain a copy of the License at
*
*      http://www.apache.org/licenses/LICENSE-2.0
*
*  Unless required by applicable law or agreed to in writing, software
*  distributed under the License is distributed on an "AS IS" BASIS,
*  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
*  See the License for the specific language governing permissions and
*  limitations under the License.
********************************************************************************/

#include "libv_internal.h"
#include "libv_apdu_constants.h"
#include "libv_apdu_get_address.h"
#include "libv_apdu_get_app_conf.h"
#include "libv_apdu_cache_send_block_data.h"
#include "libv_apdu_sign_receive_block.h"
#include "libv_apdu_sign_send_block.h"
#include "libv_apdu_get_token_info.h"
#include "libv_apdu_test_amount_text.h"
#include "libv_types.h"

uint8_t const DISPATCHER_CLA[] = {
    LIBV_CLA, // libv_apdu_get_app_conf
    LIBV_CLA, // libv_apdu_get_address
    LIBV_CLA, // libv_apdu_sign_receive_block
    LIBV_CLA, // libv_apdu_cache_send_block_data
    LIBV_CLA, // libv_apdu_sign_send_block
    LIBV_CLA, // libv_apdu_get_token_info
    LIBV_CLA, // libv_apdu_test_amount_text
};

uint8_t const DISPATCHER_INS[] = {
    LIBV_INS_GET_APP_CONF,   // libv_apdu_get_app_conf
    LIBV_INS_GET_ADDRESS,    // libv_apdu_get_address
    LIBV_INS_SIGN_RESPONSE_BLOCK,    // libv_apdu_sign_receive_block
    LIBV_INS_CACHE_REQUEST_BLOCK_DATA,     // libv_apdu_cache_send_block_data
    LIBV_INS_SIGN_REQUEST_BLOCK,     // libv_apdu_sign_send_block
    LIBV_INS_GET_TOKEN_INFO,        // libv_apdu_get_token_info
    LIBV_INS_TEST_AMOUNT_TEXT, // libv_apdu_test_amount_text
};

bool const DISPATCHER_DATA_IN[] = {
    false, // libv_apdu_get_app_conf
    true,  // libv_apdu_get_address
    true,  // libv_apdu_sign_receive_block
    true,  // libv_apdu_cache_send_block_data
    true,  // libv_apdu_sign_send_block
    true,  // libv_apdu_get_token_info
    true,  // libv_apdu_test_amount_text
};

apduProcessingFunction const DISPATCHER_FUNCTIONS[] = {
    libv_apdu_get_app_conf,
    libv_apdu_get_address,
    libv_apdu_sign_receive_block,
    libv_apdu_cache_send_block_data,
    libv_apdu_sign_send_block,
    libv_apdu_get_token_info,
    libv_apdu_test_amount_text,
};

uint8_t const BASE16_ALPHABET[16] = {
    '0', '1', '2', '3', '4', '5', '6', '7', '8', '9',
    'A', 'B', 'C', 'D', 'E', 'F' };

TOKEN_INFO const TOKEN_INFO_ARRAY[TOKEN_INFO_ARRAY_LEN] = {
    {{0x45,0xaa,0xae,0x1f,0xf7,0x8d,0x00,0x43,0x19,0x22}, "ATOM-001", 18},
    {{0x2f,0x87,0x5c,0x97,0xd3,0xa5,0x1b,0x66,0xa5,0x9c}, "ANKR-000", 18},
    {{0xbe,0x66,0xfa,0x38,0xdd,0xc9,0x48,0x30,0xe5,0x1f}, "BCH-000", 0},
    {{0xe6,0x00,0x94,0xc2,0x6d,0x62,0xaf,0x1e,0x72,0x86}, "BCHSV-000", 18},
    {{0xe0,0x04,0xd1,0xb3,0x16,0xed,0xef,0xd6,0x38,0xfd}, "BNB-000", 0},
    {{0xfe,0xd4,0x4e,0x25,0x28,0xdc,0xfb,0x08,0x29,0x8f}, "BTM-000", 18},
    {{0xa4,0x5e,0x13,0xf4,0x3b,0xcd,0xdb,0x34,0x20,0x99}, "BRC-000", 8},
    {{0x61,0xf5,0x9e,0x57,0x4f,0x9f,0x7b,0xab,0xfe,0x89}, "BAN-000", 29},
    {{0xf7,0xe1,0x87,0xa1,0x51,0xe9,0xc7,0x4b,0x81,0xe8}, "BEAM-000", 8},
    {{0x9f,0x60,0x04,0xf1,0x3f,0xfb,0xcc,0x20,0x76,0x92}, "BITT-000", 8},
    {{0xc8,0xc9,0xad,0x17,0xbc,0x7b,0x45,0xe3,0x8e,0xb8}, "BUSD-000", 18},
    {{0xe8,0x0b,0xca,0xfb,0x64,0x2c,0xe4,0x89,0x88,0x57}, "BIS-000", 8},
    {{0xd3,0x32,0xd6,0x97,0x8d,0xfa,0x5e,0x2d,0xe1,0x6b}, "BTC-001", 18},
    {{0xb9,0x0c,0x9b,0xaf,0xff,0xfc,0x9d,0xae,0x58,0xd1}, "BTC-000", 8},
    {{0x79,0x8d,0xe1,0x64,0x75,0x3a,0xdd,0xdd,0x70,0x87}, "XBG-000", 9},
    {{0xcf,0xd6,0x15,0x1e,0x2e,0x8b,0x74,0x66,0xc0,0x45}, "BRO-000", 8},
    {{0x45,0xa4,0x15,0x78,0x72,0xf1,0xc5,0x2d,0x03,0x6b}, "BID-000", 4},
    {{0xd2,0xc2,0xeb,0x74,0x5c,0x96,0xc8,0x4c,0x5c,0x6c}, "BID-001", 4},
    {{0x7b,0xe8,0x82,0xfa,0x4f,0x1a,0x2d,0x23,0x15,0xb1}, "JAVA-000", 0},
    {{0xe7,0x94,0xa0,0x43,0x89,0xcc,0x28,0x46,0x3e,0xc3}, "LINK-000", 18},
    {{0xc8,0xf5,0x1b,0x3a,0x7e,0x00,0x9c,0xcf,0x56,0xf9}, "CT-000", 16},
    {{0xd3,0x5f,0x29,0x20,0xe8,0x6d,0xfc,0xcb,0xbe,0x6d}, "ATOM-000", 6},
    {{0x26,0x47,0x2d,0x9b,0xe0,0x8f,0x8f,0x2f,0xde,0xb3}, "DERO-000", 12},
    {{0x62,0x51,0x2a,0x8e,0xe2,0x22,0x3d,0xe7,0x12,0x3a}, "DFT-000", 18},
    {{0xba,0xb0,0x59,0x06,0x55,0x70,0x90,0x32,0xc8,0x65}, "DUN-000", 6},
    {{0x16,0x27,0x45,0x6b,0x5d,0x73,0x5f,0xf5,0xa3,0x8b}, "EOS-002", 18},
    {{0x9b,0x8b,0x77,0x9b,0x0c,0xa5,0xb5,0x54,0x64,0xe1}, "EOS-003", 4},
    {{0xdf,0xbe,0x54,0xe7,0x0b,0xf0,0x2e,0xa5,0x0f,0x8c}, "EOS-000", 1},
    {{0xf7,0x5d,0x27,0xe3,0x30,0x3a,0xf7,0xc8,0x9d,0x5a}, "EOS-001", 8},
    {{0x76,0x25,0x8c,0x5f,0x9d,0xa1,0xe7,0xd3,0xfa,0xeb}, "EPIC-000", 9},
    {{0xb9,0xd6,0x22,0xc6,0x8d,0x48,0x6a,0xa1,0x07,0xa3}, "EPIC-001", 8},
    {{0x66,0x1d,0x46,0x7c,0x3f,0x4d,0x9c,0x6d,0x7b,0x9e}, "ERG-000", 9},
    {{0xbc,0x8d,0x1b,0x98,0xe4,0xc9,0x20,0x8b,0x92,0x5b}, "EFYT-000", 9},
    {{0x68,0x7d,0x8a,0x93,0x91,0x53,0x93,0xb2,0x19,0x21}, "ETH-000", 18},
    {{0x6f,0xa8,0x53,0x88,0x16,0xf1,0xa3,0x98,0x75,0xc5}, "FT-000", 18},
    {{0xb0,0xbb,0x04,0x46,0xf5,0xa2,0x17,0x03,0x80,0x1b}, "FREE-000", 8},
    {{0x21,0xa4,0x33,0x86,0x13,0x65,0x02,0x04,0x0b,0x10}, "FU-000", 8},
    {{0x5d,0x30,0x06,0x49,0x74,0x58,0x26,0x30,0xa3,0x50}, "PFCT-000", 8},
    {{0x4c,0xf2,0x20,0xa4,0x03,0xcd,0xaf,0x35,0x83,0x2e}, "GOT7-000", 7},
    {{0x6c,0x07,0xc8,0x29,0x22,0xdf,0xdd,0x74,0x35,0xea}, "GXC-000", 18},
    {{0xdf,0x49,0x0b,0x93,0x85,0x3e,0xdc,0x7e,0x23,0x02}, "GT-000", 18},
    {{0x3d,0x3b,0xd4,0xc4,0x36,0x20,0xad,0x1a,0x3b,0xcc}, "GRIMM-000", 8},
    {{0x28,0x9e,0xe0,0x56,0x9c,0x7d,0x3d,0x75,0xea,0xc1}, "GRIN-000", 9},
    {{0xbd,0x4d,0xbd,0xef,0x96,0xaa,0x07,0x5f,0xcb,0x93}, "HT-000", 18},
    {{0x43,0x9c,0x03,0x2a,0xe5,0x7b,0x9f,0x69,0xb0,0x2a}, "IRIS-000", 6},
    {{0xdf,0xa2,0x71,0x07,0x1c,0x26,0x3f,0xe8,0x35,0xc9}, "ITDC-000", 5},
    {{0x5d,0x6f,0x4d,0x2b,0x9e,0x3a,0xce,0x41,0xb5,0x44}, "ISS-000", 10},
    {{0x08,0xaf,0xae,0xad,0x8f,0xe2,0x9b,0x24,0xb6,0xda}, "IXI-000", 8},
    {{0x26,0xde,0x45,0xf0,0x44,0xe9,0xa4,0x7b,0xb8,0xc6}, "JAY-000", 8},
    {{0x09,0x6d,0x6c,0x62,0x37,0x18,0x9f,0x26,0x85,0x16}, "KAVA-000", 18},
    {{0x4a,0xa4,0xbf,0xa1,0x4b,0xb4,0xc3,0xa0,0xe4,0x0d}, "LTC-000", 8},
    {{0xb6,0x21,0x65,0xbd,0x5c,0x93,0x3a,0x54,0x95,0x7c}, "LTC-001", 18},
    {{0xa1,0xb2,0xca,0x0c,0xf2,0x42,0xc6,0x85,0x0f,0xa3}, "LYYB-000", 5},
    {{0xc0,0xbd,0x4e,0x1d,0xc8,0x2e,0x7b,0x24,0x42,0x9d}, "LAMB-000", 18},
    {{0x52,0x27,0x87,0x01,0xcf,0x99,0x30,0x8c,0x87,0x75}, "CASH-000", 8},
    {{0x4a,0x00,0x78,0x3d,0x54,0xd5,0x41,0x00,0x78,0x25}, "LRC-001", 18},
    {{0x25,0xe5,0xf1,0x91,0xcb,0xb0,0x0a,0x88,0xa6,0x26}, "LRC-000", 18},
    {{0xf8,0xb5,0xed,0xf3,0xf9,0x47,0xd1,0x5b,0x18,0x1a}, "OKB-000", 18},
    {{0x0f,0xb4,0x8a,0xba,0x4f,0x37,0xa7,0x04,0x91,0xc0}, "OAT-000", 10},
    {{0x28,0x8b,0x0c,0xa5,0x79,0x9e,0x3e,0x09,0x4e,0xe9}, "OMG-000", 18},
    {{0xde,0xb3,0x82,0xa8,0x98,0x94,0xcc,0x65,0x45,0xaf}, "PWG-000", 8},
    {{0x22,0xa8,0x18,0x22,0x7b,0xb4,0x7f,0x07,0x2f,0x92}, "PASC-000", 4},
    {{0xdf,0xa8,0x72,0xe9,0xf0,0xfc,0xcb,0x1c,0xc0,0x85}, "PEG-000", 8},
    {{0x85,0x6a,0xcf,0x39,0x14,0xea,0x1c,0x71,0x99,0x16}, "PLASMO-000", 0},
    {{0x47,0x48,0xb9,0x1e,0xb2,0xb5,0xc1,0xcd,0xfd,0x04}, "NPXS-000", 18},
    {{0xd1,0x02,0x62,0x0f,0xe0,0xe3,0x1c,0xa0,0x9c,0x4f}, "KT-000", 18},
    {{0x6e,0x15,0x95,0xd7,0x6b,0x83,0x1d,0x35,0x98,0xab}, "QC-000", 10},
    {{0x4a,0x04,0x20,0x3e,0x28,0xbb,0x8f,0x3d,0xc3,0xd8}, "XRP-001", 6},
    {{0x43,0xd6,0xfb,0xcb,0x72,0x07,0xdc,0x8d,0xd5,0xfc}, "SERO-000", 18},
    {{0x60,0xe2,0x05,0x67,0xa2,0x02,0x82,0xbf,0xd2,0x5a}, "TERA-000", 9},
    {{0xc0,0x5c,0x2c,0x2f,0xb8,0xf6,0xb4,0x28,0xe3,0xd6}, "TRB-000", 18},
    {{0x3e,0xe9,0x1c,0x86,0x08,0x64,0x52,0x79,0xd9,0xfa}, "LUNA-001", 18},
    {{0x98,0xdc,0xd9,0xb7,0x70,0xf0,0x9b,0xfd,0xe9,0xfb}, "LUNA-000", 18},
    {{0x2c,0x7a,0xe6,0xe8,0x9a,0x43,0xfd,0x4c,0x5b,0x61}, "ABC-000", 6},
    {{0x80,0xf3,0x75,0x14,0x85,0xe4,0xe8,0x34,0x56,0x05}, "USDT-000", 6},
    {{0x82,0x8a,0x6b,0x66,0x11,0x6f,0xc7,0xc1,0x00,0xf0}, "XTZ-000", 8},
    {{0x05,0x70,0xe7,0x63,0x91,0x8b,0x43,0x55,0x07,0x46}, "TRTL-000", 2},
    {{0x18,0x82,0x3e,0x6e,0x0b,0x95,0xb7,0xd7,0x7b,0x3a}, "VFC-000", 3},
    {{0x56,0x49,0x54,0x45,0x20,0x54,0x4f,0x4b,0x45,0x4e}, "VITE", 18},
    {{0x3c,0xcb,0x0f,0xe9,0x84,0x5a,0x72,0x0b,0x65,0x03}, "VGC-000", 18},
    {{0x25,0x1a,0x3e,0x67,0xa4,0x1b,0x5e,0xa2,0x37,0x39}, "VCP", 0},
    {{0x57,0x27,0xd5,0x01,0x6d,0x9c,0xf5,0x8a,0x35,0x08}, "VMT-000", 18},
    {{0x19,0x49,0x75,0x41,0x00,0xb9,0xb4,0x91,0xe7,0xd3}, "VXS-000", 8},
    {{0xd9,0x58,0x7c,0xd6,0x93,0x59,0x06,0x94,0x6b,0x80}, "VIP-000", 16},
    {{0x56,0x49,0x54,0x45,0x58,0x20,0x43,0x4f,0x49,0x4e}, "VX", 18},
    {{0x5b,0x83,0x47,0xd7,0xd9,0x50,0x7a,0x56,0x0c,0x10}, "WEPAY-000", 18},
    {{0x3f,0xa5,0x48,0x49,0x1a,0xe1,0x30,0x9f,0xb6,0x04}, "WAVES-000", 8},
    {{0xd1,0x50,0x0c,0xb8,0x5c,0x9d,0x2d,0x7b,0xb0,0x8a}, "XRP-000", 1},
    {{0x0a,0x81,0xc0,0x2b,0x5b,0x94,0x65,0x30,0x81,0xba}, "ZRX-000", 18},
    {{0x7d,0x37,0xe4,0x3b,0x93,0x43,0x8b,0x2d,0x64,0x31}, "ZCL-000", 8},
    {{0x8e,0xbb,0x5d,0x61,0xf2,0x9b,0x5e,0xf6,0x1b,0xb3}, "BTC-002", 0},
    {{0x81,0x5d,0x91,0x8b,0x39,0x7f,0x85,0xf7,0x0d,0xda}, "PFCT-001", 8},
    {{0x3c,0xc6,0xdd,0xdf,0xb5,0x3f,0x3c,0xc5,0xfb,0xb4}, "PGOLD-001", 8},
    {{0xf0,0xf3,0x0d,0x3d,0x33,0x7b,0xb4,0xbc,0x50,0xb4}, "PGOLD-000", 8},
    {{0xc1,0x96,0x8f,0xde,0x12,0xbe,0x9b,0xc6,0x0e,0x56}, "PUSD-000", 8},
    {{0xf7,0x33,0xa3,0xa2,0xa4,0x64,0xe9,0xa0,0xd2,0xef}, "VTE-000", 0},
};

